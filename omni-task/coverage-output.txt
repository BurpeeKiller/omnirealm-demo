â–² [WARNING] Duplicate key "docs:validate" in object literal [duplicate-object-key]

    ../../../package.json:168:4:
      168 â”‚     "docs:validate": "echo 'ğŸ“ Validation structure documentati...
          â•µ     ~~~~~~~~~~~~~~~

  The original key "docs:validate" is here:

    ../../../package.json:67:4:
      67 â”‚     "docs:validate": "node shared/scripts/maintenance/validate-doc...
         â•µ     ~~~~~~~~~~~~~~~

â–² [WARNING] Duplicate key "docs:build" in object literal [duplicate-object-key]

    ../../../package.json:169:4:
      169 â”‚     "docs:build": "echo 'ğŸ—ï¸ GÃ©nÃ©ration site documentation....
          â•µ     ~~~~~~~~~~~~

  The original key "docs:build" is here:

    ../../../package.json:62:4:
      62 â”‚     "docs:build": "vitepress build docs",
         â•µ     ~~~~~~~~~~~~


 RUN  v3.2.4 /home/greg/projets/dev/apps/omni-task
      Coverage enabled with v8

 â¯ |omni-task| components/ui/__tests__/modal.test.tsx (14 tests | 1 failed) 430ms
   âœ“ Modal > Affichage > ne devrait rien afficher si isOpen est false 32ms
   âœ“ Modal > Affichage > devrait afficher le modal si isOpen est true 58ms
   âœ“ Modal > Affichage > devrait appliquer les classes CSS personnalisÃ©es 15ms
   âœ“ Modal > Interactions > devrait appeler onClose en cliquant sur le bouton fermer 156ms
   âœ“ Modal > Interactions > devrait appeler onClose en cliquant sur le backdrop 33ms
   âœ“ Modal > Interactions > devrait appeler onClose en appuyant sur Escape 18ms
   âœ“ Modal > Interactions > ne devrait pas Ã©couter Escape si le modal est fermÃ© 10ms
   âœ“ Modal > Gestion du scroll > devrait bloquer le scroll du body quand ouvert 10ms
   âœ“ Modal > Gestion du scroll > devrait restaurer le scroll du body quand fermÃ© 11ms
   âœ“ Modal > Gestion du scroll > devrait nettoyer les event listeners au dÃ©montage 15ms
   âœ“ Modal > Structure > devrait avoir la structure correcte 22ms
   âœ“ Modal > Structure > devrait avoir les bonnes classes pour le conteneur principal 8ms
   âœ“ useModalContainer > devrait retourner null quand utilisÃ© en dehors du contexte 6ms
   Ã— useModalContainer > devrait retourner la rÃ©fÃ©rence du modal quand utilisÃ© dans le contexte 29ms
     â†’ [2mexpect([22m[31melement[39m[2m).toHaveTextContent()[22m

Expected element to have text content:
[32m  Has container[39m
Received:
[31m  No container[39m
 â¯ |omni-task| lib/store/__tests__/toast-store.test.ts (16 tests | 2 failed) 114ms
   âœ“ useToastStore > Ã‰tat initial > devrait avoir un Ã©tat initial vide 11ms
   âœ“ useToastStore > addToast > devrait ajouter un toast avec un ID unique 13ms
   âœ“ useToastStore > addToast > devrait supprimer automatiquement le toast aprÃ¨s la durÃ©e spÃ©cifiÃ©e 6ms
   âœ“ useToastStore > addToast > devrait utiliser une durÃ©e par dÃ©faut de 3 secondes 8ms
   Ã— useToastStore > removeToast > devrait supprimer un toast spÃ©cifique 15ms
     â†’ expected [] to have a length of 2 but got +0
   âœ“ useToastStore > success > devrait ajouter un toast de succÃ¨s 6ms
   âœ“ useToastStore > success > devrait supprimer automatiquement aprÃ¨s 3 secondes 5ms
   âœ“ useToastStore > error > devrait ajouter un toast d'erreur 5ms
   âœ“ useToastStore > error > devrait supprimer automatiquement aprÃ¨s 5 secondes 5ms
   âœ“ useToastStore > info > devrait ajouter un toast d'info 5ms
   âœ“ useToastStore > info > devrait supprimer automatiquement aprÃ¨s 3 secondes 6ms
   âœ“ useToastStore > warning > devrait ajouter un toast d'avertissement 6ms
   âœ“ useToastStore > warning > devrait supprimer automatiquement aprÃ¨s 4 secondes 5ms
   âœ“ useToastStore > Gestion de plusieurs toasts > devrait gÃ©rer plusieurs toasts simultanÃ©ment 5ms
   Ã— useToastStore > Gestion de plusieurs toasts > devrait supprimer les toasts dans le bon ordre 6ms
     â†’ expected [] to have a length of 2 but got +0
   âœ“ useToastStore > IDs uniques > devrait gÃ©nÃ©rer des IDs uniques mÃªme pour des toasts crÃ©Ã©s rapidement 6ms
 â¯ |omni-task| app/api/tasks/__tests__/route.test.ts (6 tests | 4 failed) 58ms
   âœ“ Tasks API - Simplified > GET /api/tasks > devrait retourner 401 si non authentifiÃ© 24ms
   Ã— Tasks API - Simplified > GET /api/tasks > devrait retourner les tÃ¢ches de l'utilisateur 11ms
     â†’ expected { data: [ { id: '1', â€¦(2) }, â€¦(1) ] } to deeply equal [ â€¦(2) ]
   Ã— Tasks API - Simplified > POST /api/tasks > devrait crÃ©er une nouvelle tÃ¢che 9ms
     â†’ expected { data: { title: 'New Task', â€¦(4) } } to match object { title: 'New Task', â€¦(2) }
(6 matching properties omitted from actual)
   âœ“ Tasks API - Simplified > POST /api/tasks > devrait retourner 401 si non authentifiÃ© 3ms
   Ã— Tasks API - Simplified > PATCH /api/tasks > devrait retourner 401 si non authentifiÃ© 5ms
     â†’ Cannot destructure property 'params' of 'undefined' as it is undefined.
   Ã— Tasks API - Simplified > DELETE /api/tasks > devrait retourner 401 si non authentifiÃ© 6ms
     â†’ Cannot destructure property 'params' of 'undefined' as it is undefined.
stderr | components/__tests__/task-form.test.tsx > TaskForm > Mode crÃ©ation > devrait afficher le titre "Nouvelle tÃ¢che"
Warning: Invalid value for prop `data-onvaluechange` on <div> tag. Either remove it from the element, or pass a string or number value to keep it in the DOM. For details, see https://reactjs.org/link/attribute-behavior 
    at div
    at Select (/home/greg/projets/dev/apps/omni-task/components/__tests__/task-form.test.tsx:19:14)
    at div
    at div
    at form
    at div
    at Modal (/home/greg/projets/dev/apps/omni-task/components/__tests__/task-form.test.tsx:4:13)
    at TaskForm (/home/greg/projets/dev/apps/omni-task/components/task-form.tsx:11:21)

stdout | components/__tests__/task-form.test.tsx > TaskForm > Mode crÃ©ation > devrait crÃ©er une nouvelle tÃ¢che
Saving task: {
  title: [32m'Nouvelle tÃ¢che test'[39m,
  description: [32m'Description de test'[39m,
  status: [32m'TODO'[39m,
  priority: [32m'MEDIUM'[39m,
  projectId: [90mundefined[39m,
  dueDate: [32m'2024-12-25'[39m,
  estimatedHours: [33m4.5[39m,
  tags: [ [32m'test'[39m, [32m'vitest'[39m, [32m'react'[39m ]
}

stdout | components/__tests__/task-form.test.tsx > TaskForm > Mode crÃ©ation > devrait utiliser le status par dÃ©faut fourni
Saving task: {
  title: [32m'Test'[39m,
  description: [90mundefined[39m,
  status: [32m'IN_PROGRESS'[39m,
  priority: [32m'MEDIUM'[39m,
  projectId: [90mundefined[39m,
  dueDate: [90mundefined[39m,
  estimatedHours: [90mundefined[39m,
  tags: [90mundefined[39m
}

stdout | components/__tests__/task-form.test.tsx > TaskForm > Mode crÃ©ation > devrait gÃ©rer les erreurs de crÃ©ation
Saving task: {
  title: [32m'Test'[39m,
  description: [90mundefined[39m,
  status: [32m'TODO'[39m,
  priority: [32m'MEDIUM'[39m,
  projectId: [90mundefined[39m,
  dueDate: [90mundefined[39m,
  estimatedHours: [90mundefined[39m,
  tags: [90mundefined[39m
}

stderr | components/__tests__/task-form.test.tsx > TaskForm > Mode crÃ©ation > devrait gÃ©rer les erreurs de crÃ©ation
Error saving task: Error: Erreur de crÃ©ation
    at [90m/home/greg/projets/dev/apps/omni-task/[39mcomponents/__tests__/task-form.test.tsx:174:37
    at file:///home/greg/projets/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:155:11
    at file:///home/greg/projets/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:752:26
    at file:///home/greg/projets/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///home/greg/projets/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:1863:10)
    at runTest (file:///home/greg/projets/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:1574:12)
    at runSuite (file:///home/greg/projets/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (file:///home/greg/projets/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (file:///home/greg/projets/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:1729:8)

stdout | components/__tests__/task-form.test.tsx > TaskForm > Mode Ã©dition > devrait mettre Ã  jour la tÃ¢che
Saving task: {
  title: [32m'TÃ¢che modifiÃ©e'[39m,
  description: [32m'Description existante'[39m,
  status: [32m'TODO'[39m,
  priority: [32m'HIGH'[39m,
  projectId: [32m'project1'[39m,
  dueDate: [32m'2024-12-31'[39m,
  estimatedHours: [33m8[39m,
  tags: [ [32m'bug'[39m, [32m'urgent'[39m ]
}

stdout | components/__tests__/task-form.test.tsx > TaskForm > Mode Ã©dition > devrait gÃ©rer les erreurs de mise Ã  jour
Saving task: {
  title: [32m'TÃ¢che existante'[39m,
  description: [32m'Description existante'[39m,
  status: [32m'TODO'[39m,
  priority: [32m'HIGH'[39m,
  projectId: [32m'project1'[39m,
  dueDate: [32m'2024-12-31'[39m,
  estimatedHours: [33m8[39m,
  tags: [ [32m'bug'[39m, [32m'urgent'[39m ]
}

stderr | components/__tests__/task-form.test.tsx > TaskForm > Mode Ã©dition > devrait gÃ©rer les erreurs de mise Ã  jour
Error saving task: Error: Erreur de mise Ã  jour
    at [90m/home/greg/projets/dev/apps/omni-task/[39mcomponents/__tests__/task-form.test.tsx:253:40
    at file:///home/greg/projets/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:155:11
    at file:///home/greg/projets/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:752:26
    at file:///home/greg/projets/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///home/greg/projets/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:1863:10)
    at runTest (file:///home/greg/projets/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:1574:12)
    at runSuite (file:///home/greg/projets/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (file:///home/greg/projets/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (file:///home/greg/projets/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:1729:8)

stdout | components/__tests__/task-form.test.tsx > TaskForm > Interactions communes > devrait gÃ©rer les tags correctement
Saving task: {
  title: [32m'Test'[39m,
  description: [90mundefined[39m,
  status: [32m'TODO'[39m,
  priority: [32m'MEDIUM'[39m,
  projectId: [90mundefined[39m,
  dueDate: [90mundefined[39m,
  estimatedHours: [90mundefined[39m,
  tags: [ [32m'tag1'[39m, [32m'tag2'[39m, [32m'tag3'[39m ]
}

 âœ“ |omni-task| components/__tests__/task-form.test.tsx (15 tests) 1952ms
   âœ“ TaskForm > Mode crÃ©ation > devrait crÃ©er une nouvelle tÃ¢che  769ms
stderr | app/(auth)/register/__tests__/page.test.tsx > RegisterPage > Inscription rÃ©ussie > devrait utiliser le fallback si la fonction RPC Ã©choue
Erreur lors de la configuration du profil: { message: [32m'RPC failed'[39m }

 âœ“ |omni-task| app/(auth)/register/__tests__/page.test.tsx (12 tests) 1980ms
   âœ“ RegisterPage > Inscription rÃ©ussie > devrait crÃ©er un compte avec succÃ¨s  339ms
   âœ“ RegisterPage > Inscription rÃ©ussie > devrait utiliser le fallback si la fonction RPC Ã©choue  303ms
   âœ“ RegisterPage > Gestion des erreurs > devrait afficher une erreur si l'inscription Ã©choue  312ms
   âœ“ RegisterPage > Gestion des erreurs > devrait afficher un message d'erreur gÃ©nÃ©rique  330ms
   âœ“ RegisterPage > Ã‰tat du formulaire > devrait dÃ©sactiver les champs pendant le chargement  323ms
 âœ“ |omni-task| app/(auth)/login/__tests__/page.test.tsx (11 tests) 1250ms
 âœ“ |omni-task| components/kanban/__tests__/task-card.test.tsx (14 tests) 221ms
 âœ“ |omni-task| components/kanban/__tests__/kanban-board.test.tsx (7 tests) 136ms
 âœ“ |omni-task| app/dashboard/__tests__/page.test.tsx (7 tests) 135ms
 âœ“ |omni-task| components/kanban/__tests__/kanban-column.test.tsx (8 tests) 101ms
 âœ“ |omni-task| lib/store/__tests__/task-store.test.ts (15 tests | 2 skipped) 82ms
 âœ“ |omni-task| components/__tests__/toast.test.tsx (9 tests) 83ms

â¯â¯â¯â¯â¯â¯â¯ Failed Tests 7 â¯â¯â¯â¯â¯â¯â¯

 FAIL  |omni-task| components/ui/__tests__/modal.test.tsx > useModalContainer > devrait retourner la rÃ©fÃ©rence du modal quand utilisÃ© dans le contexte
Error: [2mexpect([22m[31melement[39m[2m).toHaveTextContent()[22m

Expected element to have text content:
[32m  Has container[39m
Received:
[31m  No container[39m
 â¯ components/ui/__tests__/modal.test.tsx:223:45
    221|     )
    222| 
    223|     expect(screen.getByTestId('container')).toHaveTextContent('Has conâ€¦
       |                                             ^
    224|   })
    225| })

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[1/7]â¯

 FAIL  |omni-task| lib/store/__tests__/toast-store.test.ts > useToastStore > removeToast > devrait supprimer un toast spÃ©cifique
AssertionError: expected [] to have a length of 2 but got +0

[32m- Expected[39m
[31m+ Received[39m

[32m- 2[39m
[31m+ 0[39m

 â¯ lib/store/__tests__/toast-store.test.ts:109:37
    107|       })
    108| 
    109|       expect(result.current.toasts).toHaveLength(2)
       |                                     ^
    110|       expect(result.current.toasts.find(t => t.id === toastToRemove.idâ€¦
    111|       expect(result.current.toasts[0].message).toBe('Toast 1')

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[2/7]â¯

 FAIL  |omni-task| lib/store/__tests__/toast-store.test.ts > useToastStore > Gestion de plusieurs toasts > devrait supprimer les toasts dans le bon ordre
AssertionError: expected [] to have a length of 2 but got +0

[32m- Expected[39m
[31m+ Received[39m

[32m- 2[39m
[31m+ 0[39m

 â¯ lib/store/__tests__/toast-store.test.ts:282:37
    280|         vi.advanceTimersByTime(3000)
    281|       })
    282|       expect(result.current.toasts).toHaveLength(2)
       |                                     ^
    283|       expect(result.current.toasts.find(t => t.type === 'success')).toâ€¦
    284| 

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[3/7]â¯

 FAIL  |omni-task| app/api/tasks/__tests__/route.test.ts > Tasks API - Simplified > GET /api/tasks > devrait retourner les tÃ¢ches de l'utilisateur
AssertionError: expected { data: [ { id: '1', â€¦(2) }, â€¦(1) ] } to deeply equal [ â€¦(2) ]

[32m- Expected:[39m 
[
  {
    "id": "1",
    "title": "Task 1",
    "user_id": "user123",
  },
  {
    "id": "2",
    "title": "Task 2",
    "user_id": "user123",
  },
]

[31m+ Received:[39m 
{
  "data": [
    {
      "id": "1",
      "title": "Task 1",
      "user_id": "user123",
    },
    {
      "id": "2",
      "title": "Task 2",
      "user_id": "user123",
    },
  ],
}

 â¯ app/api/tasks/__tests__/route.test.ts:90:20
     88| 
     89|       expect(response.status).toBe(200)
     90|       expect(data).toEqual(mockTasks)
       |                    ^
     91|       expect(mockSupabase.from).toHaveBeenCalledWith('tasks')
     92|       expect(mockSupabase.eq).toHaveBeenCalledWith('user_id', 'user123â€¦

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[4/7]â¯

 FAIL  |omni-task| app/api/tasks/__tests__/route.test.ts > Tasks API - Simplified > POST /api/tasks > devrait crÃ©er une nouvelle tÃ¢che
AssertionError: expected { data: { title: 'New Task', â€¦(4) } } to match object { title: 'New Task', â€¦(2) }
(6 matching properties omitted from actual)

[32m- Expected[39m
[31m+ Received[39m

[2m  {[22m
[31m+   "data": {[39m
[31m+     "id": "task123",[39m
[2m      "priority": "HIGH",[22m
[2m      "status": "TODO",[22m
[2m      "title": "New Task",[22m
[31m+     "user_id": "user123",[39m
[31m+   },[39m
[2m  }[22m

 â¯ app/api/tasks/__tests__/route.test.ts:131:20
    129| 
    130|       expect(response.status).toBe(201)
    131|       expect(data).toMatchObject(newTask)
       |                    ^
    132|     })
    133| 

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[5/7]â¯

 FAIL  |omni-task| app/api/tasks/__tests__/route.test.ts > Tasks API - Simplified > PATCH /api/tasks > devrait retourner 401 si non authentifiÃ©
TypeError: Cannot destructure property 'params' of 'undefined' as it is undefined.
 â¯ Module.PATCH app/api/tasks/route.ts:132:5
    130| export async function PATCH(
    131|   request: NextRequest,
    132|   { params }: { params: { id: string } }
       |     ^
    133| ) {
    134|   try {
 â¯ app/api/tasks/__tests__/route.test.ts:162:30

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[6/7]â¯

 FAIL  |omni-task| app/api/tasks/__tests__/route.test.ts > Tasks API - Simplified > DELETE /api/tasks > devrait retourner 401 si non authentifiÃ©
TypeError: Cannot destructure property 'params' of 'undefined' as it is undefined.
 â¯ Module.DELETE app/api/tasks/route.ts:208:5
    206| export async function DELETE(
    207|   request: NextRequest,
    208|   { params }: { params: { id: string } }
       |     ^
    209| ) {
    210|   try {
 â¯ app/api/tasks/__tests__/route.test.ts:175:30

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[7/7]â¯


 Test Files  3 failed | 9 passed (12)
      Tests  7 failed | 125 passed | 2 skipped (134)
   Start at  20:57:03
   Duration  12.52s (transform 757ms, setup 533ms, collect 2.58s, tests 6.54s, environment 906ms, prepare 176ms)

